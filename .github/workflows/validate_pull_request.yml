on: pull_request

jobs:
  validate:
    name: Validate build
    runs-on: ubuntu-latest
    container: python:3
    steps:
      - name: Checkout spdx-spec
        uses: actions/checkout@v4
        with:
          path: spdx-spec
          fetch-depth: 1
      - name: Checkout spdx-3-model
        uses: actions/checkout@v4
        with:
          repository: spdx/spdx-3-model
          ref: refs/tags/3.0  # Fixed to v3.0 to reduce moving parts
          path: spdx-3-model
      - name: Checkout spec-parser
        uses: actions/checkout@v4
        with:
          repository: spdx/spec-parser
          ref: main
          path: spec-parser
      - name: Install pre-requisites for spdx-spec
        run: pip install -r spdx-spec/requirements.txt
      - name: Install pre-requisites for spec-parser
        run: pip install -r spec-parser/requirements.txt
      - name: Build model
        run: python3 spec-parser/main.py spdx-3-model/model spdx-spec/docs/model
      - name: Build docs
        run: mkdocs build -v --clean
        working-directory: spdx-spec
